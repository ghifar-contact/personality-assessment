<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personality Style Assessment</title>
    <div id="emailSection" style="margin: 20px 0;">
    <label for="userEmail" style="display: block; margin-bottom: 8px; font-weight: 500;">
        Enter your email (optional, for results):
    </label>
    <input 
        type="email" 
        id="userEmail" 
        placeholder="name@company.com"
        style="padding: 12px; width: 300px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 1rem;">
    </div>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        /* Welcome Screen */
        .welcome-screen {
            padding: 60px 40px;
            text-align: center;
        }
        
        .welcome-screen h1 {
            font-size: 2.5rem;
            color: #333;
            margin-bottom: 20px;
        }
        
        .welcome-screen p {
            color: #666;
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 30px;
        }
        
        .start-btn {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.2rem;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            transition: transform 0.3s;
        }
        
        .start-btn:hover {
            transform: translateY(-2px);
        }
        
        /* Question Screen */
        .question-screen {
            padding: 40px;
            display: none;
        }
        
        .progress-bar {
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            margin-bottom: 30px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4f46e5, #7c3aed);
            width: 0%;
            transition: width 0.5s;
        }
        
        .question-container {
            margin-bottom: 30px;
        }
        
        .question-number {
            color: #4f46e5;
            font-weight: 600;
            margin-bottom: 10px;
            font-size: 0.9rem;
        }
        
        .question-text {
            font-size: 1.3rem;
            color: #333;
            margin-bottom: 25px;
            line-height: 1.5;
        }
        
        .options-container {
            display: grid;
            gap: 12px;
        }
        
        .option-btn {
            padding: 18px 20px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            background: white;
            font-size: 1rem;
            text-align: left;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .option-btn:hover {
            border-color: #4f46e5;
            background: #f8fafc;
        }
        
        .option-btn.selected {
            border-color: #4f46e5;
            background: rgba(79, 70, 229, 0.1);
        }
        
        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 1px solid #e2e8f0;
        }
        
        .nav-btn {
            padding: 12px 30px;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .prev-btn {
            background: #f1f5f9;
            color: #64748b;
        }
        
        .prev-btn:hover {
            background: #e2e8f0;
        }
        
        .next-btn {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
        }
        
        .next-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(79, 70, 229, 0.3);
        }
        
        .submit-btn {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }
        
        /* Results Screen */
        .results-screen {
            padding: 40px;
            display: none;
        }
        
        .results-header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .results-header h2 {
            font-size: 2rem;
            color: #333;
            margin-bottom: 10px;
        }
        
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .domain-card {
            background: #f8fafc;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            border: 2px solid #e2e8f0;
            transition: all 0.3s;
        }
        
        .domain-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .domain-name {
            font-size: 1.2rem;
            font-weight: 600;
            color: #334155;
            margin-bottom: 10px;
        }
        
        .domain-score {
            font-size: 2.5rem;
            font-weight: 800;
            color: #4f46e5;
            margin: 10px 0;
        }
        
        .domain-total {
            color: #64748b;
            font-size: 0.9rem;
        }
        
        .results-summary {
            background: #f1f5f9;
            border-radius: 15px;
            padding: 30px;
            margin-top: 30px;
        }
        
        .results-summary h3 {
            color: #334155;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        
        .restart-btn {
            display: block;
            margin: 40px auto 0;
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.1rem;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Welcome Screen -->
        <div class="welcome-screen" id="welcomeScreen">
            <h1>Personality Style Assessment</h1>
            <p>This assessment measures your natural style across four key dimensions: Direct, Spirited, Considerate, and Systematic.</p>
            <p>For each question, select the option that best describes you or your preferences.</p>
            <p><strong>Time to complete:</strong> Approximately 5-7 minutes</p>
            <button class="start-btn" onclick="startAssessment()">Start Assessment</button>
        </div>
        
        <!-- Question Screen -->
        <div class="question-screen" id="questionScreen">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            
            <div class="question-container">
                <div class="question-number" id="questionNumber">Question 1 of 24</div>
                <div class="question-text" id="questionText">Loading question...</div>
                
                <div class="options-container" id="optionsContainer">
                    <!-- Options will be inserted here -->
                </div>
            </div>
            
            <div class="navigation">
                <button class="nav-btn prev-btn" id="prevBtn" onclick="prevQuestion()">Previous</button>
                <button class="nav-btn next-btn" id="nextBtn" onclick="nextQuestion()">Next Question</button>
            </div>
        </div>
        
        <!-- Results Screen -->
        <div class="results-screen" id="resultsScreen">
            <div class="results-header">
                <h2>Your Personality Style Results</h2>
                <p>Based on your responses, here are your scores across the four dimensions:</p>
            </div>
            
            <div class="results-grid" id="resultsGrid">
                <!-- Results will be inserted here -->
            </div>
            
            <div class="results-summary">
                <h3>Understanding Your Scores</h3>
                <p>Each score represents how many of your answers aligned with that particular dimension. The higher the score, the more that style represents your natural tendencies.</p>
                <p><strong>Direct:</strong> Decisive, results-oriented, competitive</p>
                <p><strong>Spirited:</strong> Enthusiastic, social, persuasive</p>
                <p><strong>Considerate:</strong> Patient, supportive, cooperative</p>
                <p><strong>Systematic:</strong> Analytical, precise, quality-focused</p>
            </div>
            
            <button class="restart-btn" onclick="restartAssessment()">Take Assessment Again</button>
        </div>
    </div>

    <script>
        // ============================================================
        // CONFIGURATION SECTION - EDIT THESE VALUES
        // ============================================================
        
        // DOMAIN NAMES - EDIT THESE IF YOU WANT TO CHANGE DOMAIN LABELS
        // ============================================================
        const DOMAINS = {
            'A': 'Direct',        // EDIT THIS TEXT ONLY
            'B': 'Spirited',      // EDIT THIS TEXT ONLY
            'C': 'Considerate',   // EDIT THIS TEXT ONLY
            'D': 'Systematic'     // EDIT THIS TEXT ONLY
        };
        
        // YOUR SPECIFIC MAPPING FROM THE PROVIDED LIST
        // Format: Each string of 4 letters = mapping for one question
        // First letter = Domain for Option A, Second = Option B, etc.
        // ============================================================
        const MAPPING_STRINGS = [
            'ABCD',  // Q1: A=Direct, B=Spirited, C=Considerate, D=Systematic
            'CABD',  // Q2: A=Considerate, B=Direct, C=Spirited, D=Systematic
            'DACB',  // Q3: A=Systematic, B=Direct, C=Considerate, D=Spirited
            'BDAC',  // Q4: A=Spirited, B=Systematic, C=Direct, D=Considerate
            'CBDA',  // Q5: A=Considerate, B=Spirited, C=Systematic, D=Direct
            'ABDC',  // Q6: A=Direct, B=Spirited, C=Systematic, D=Considerate
            'BDCA',  // Q7: A=Spirited, B=Systematic, C=Considerate, D=Direct
            'BCAD',  // Q8: A=Spirited, B=Considerate, C=Direct, D=Systematic
            'CADB',  // Q9: A=Considerate, B=Direct, C=Systematic, D=Spirited
            'ACBD',  // Q10: A=Direct, B=Considerate, C=Spirited, D=Systematic
            'CBAD',  // Q11: A=Considerate, B=Spirited, C=Direct, D=Systematic
            'CABD',  // Q12: A=Considerate, B=Direct, C=Spirited, D=Systematic
            'BCDA',  // Q13: A=Spirited, B=Considerate, C=Systematic, D=Direct
            'BACD',  // Q14: A=Spirited, B=Direct, C=Considerate, D=Systematic
            'CDBA',  // Q15: A=Considerate, B=Systematic, C=Spirited, D=Direct
            'ACDB',  // Q16: A=Direct, B=Considerate, C=Systematic, D=Spirited
            'DBAC',  // Q17: A=Systematic, B=Spirited, C=Direct, D=Considerate
            'BDCA',  // Q18: A=Spirited, B=Systematic, C=Considerate, D=Direct
            'ACBD',  // Q19: A=Direct, B=Considerate, C=Spirited, D=Systematic
            'CBDA',  // Q20: A=Considerate, B=Spirited, C=Systematic, D=Direct
            'CDAB',  // Q21: A=Considerate, B=Systematic, C=Direct, D=Spirited
            'DCAB',  // Q22: A=Systematic, B=Considerate, C=Direct, D=Spirited
            'ACBD',  // Q23: A=Direct, B=Considerate, C=Spirited, D=Systematic
            'DABC'   // Q24: A=Systematic, B=Direct, C=Spirited, D=Considerate
        ];
        
        // QUESTIONS ARRAY - EDIT THE QUESTION TEXT AND OPTIONS HERE
        // ============================================================
        const QUESTIONS = [
            {
                // EDIT THIS QUESTION TEXT ONLY - Keep the mapping as is
                text: "q1: This is where you put your actual question 1 text",
                // EDIT THESE OPTION TEXTS ONLY - Keep the labels as Option A, B, C, D
                options: ["Option A", "Option B", "Option C", "Option D"],
                mapping: MAPPING_STRINGS[0].split('') // Don't change this line
            },
            {
                text: "q2: This is where you put your actual question 2 text",
                options: ["Option A", "Option B", "Option C", "Option D"],
                mapping: MAPPING_STRINGS[1].split('')
            },
            {
                text: "q3: This is where you put your actual question 3 text",
                options: ["Option A", "Option B", "Option C", "Option D"],
                mapping: MAPPING_STRINGS[2].split('')
            },
            {
                text: "q4: This is where you put your actual question 4 text",
                options: ["Option A", "Option B", "Option C", "Option D"],
                mapping: MAPPING_STRINGS[3].split('')
            },
            {
                text: "q5: This is where you put your actual question 5 text",
                options: ["Option A", "Option B", "Option C", "Option D"],
                mapping: MAPPING_STRINGS[4].split('')
            },
            {
                text: "q6: This is where you put your actual question 6 text",
                options: ["Option A", "Option B", "Option C", "Option D"],
                mapping: MAPPING_STRINGS[5].split('')
            },
            {
                text: "q7: This is where you put your actual question 7 text",
                options: ["Option A", "Option B", "Option C", "Option D"],
                mapping: MAPPING_STRINGS[6].split('')
            },
            {
                text: "q8: This is where you put your actual question 8 text",
                options: ["Option A", "Option B", "Option C", "Option D"],
                mapping: MAPPING_STRINGS[7].split('')
            },
            {
                text: "q9: This is where you put your actual question 9 text",
                options: ["Option A", "Option B", "Option C", "Option D"],
                mapping: MAPPING_STRINGS[8].split('')
            },
            {
                text: "q10: This is where you put your actual question 10 text",
                options: ["Option A", "Option B", "Option C", "Option D"],
                mapping: MAPPING_STRINGS[9].split('')
            },
            {
                text: "q11: This is where you put your actual question 11 text",
                options: ["Option A", "Option B", "Option C", "Option D"],
                mapping: MAPPING_STRINGS[10].split('')
            },
            {
                text: "q12: This is where you put your actual question 12 text",
                options: ["Option A", "Option B", "Option C", "Option D"],
                mapping: MAPPING_STRINGS[11].split('')
            },
            {
                text: "q13: This is where you put your actual question 13 text",
                options: ["Option A", "Option B", "Option C", "Option D"],
                mapping: MAPPING_STRINGS[12].split('')
            },
            {
                text: "q14: This is where you put your actual question 14 text",
                options: ["Option A", "Option B", "Option C", "Option D"],
                mapping: MAPPING_STRINGS[13].split('')
            },
            {
                text: "q15: This is where you put your actual question 15 text",
                options: ["Option A", "Option B", "Option C", "Option D"],
                mapping: MAPPING_STRINGS[14].split('')
            },
            {
                text: "q16: This is where you put your actual question 16 text",
                options: ["Option A", "Option B", "Option C", "Option D"],
                mapping: MAPPING_STRINGS[15].split('')
            },
            {
                text: "q17: This is where you put your actual question 17 text",
                options: ["Option A", "Option B", "Option C", "Option D"],
                mapping: MAPPING_STRINGS[16].split('')
            },
            {
                text: "q18: This is where you put your actual question 18 text",
                options: ["Option A", "Option B", "Option C", "Option D"],
                mapping: MAPPING_STRINGS[17].split('')
            },
            {
                text: "q19: This is where you put your actual question 19 text",
                options: ["Option A", "Option B", "Option C", "Option D"],
                mapping: MAPPING_STRINGS[18].split('')
            },
            {
                text: "q20: This is where you put your actual question 20 text",
                options: ["Option A", "Option B", "Option C", "Option D"],
                mapping: MAPPING_STRINGS[19].split('')
            },
            {
                text: "q21: This is where you put your actual question 21 text",
                options: ["Option A", "Option B", "Option C", "Option D"],
                mapping: MAPPING_STRINGS[20].split('')
            },
            {
                text: "q22: This is where you put your actual question 22 text",
                options: ["Option A", "Option B", "Option C", "Option D"],
                mapping: MAPPING_STRINGS[21].split('')
            },
            {
                text: "q23: This is where you put your actual question 23 text",
                options: ["Option A", "Option B", "Option C", "Option D"],
                mapping: MAPPING_STRINGS[22].split('')
            },
            {
                text: "q24: This is where you put your actual question 24 text",
                options: ["Option A", "Option B", "Option C", "Option D"],
                mapping: MAPPING_STRINGS[23].split('')
            }
        ];
        
        // ============================================================
        // END OF CONFIGURATION - DO NOT EDIT BELOW THIS LINE
        // ============================================================
        
        // ========== STATE MANAGEMENT ==========
        let currentQuestion = 0;
        let answers = new Array(QUESTIONS.length).fill(null);
        let domainScores = {A: 0, B: 0, C: 0, D: 0};
        
        // ========== DOM ELEMENTS ==========
        const welcomeScreen = document.getElementById('welcomeScreen');
        const questionScreen = document.getElementById('questionScreen');
        const resultsScreen = document.getElementById('resultsScreen');
        const questionNumber = document.getElementById('questionNumber');
        const questionText = document.getElementById('questionText');
        const optionsContainer = document.getElementById('optionsContainer');
        const progressFill = document.getElementById('progressFill');
        const nextBtn = document.getElementById('nextBtn');
        const prevBtn = document.getElementById('prevBtn');
        const resultsGrid = document.getElementById('resultsGrid');
        
        // ========== FUNCTIONS ==========
        function startAssessment() {
                const email = document.getElementById('userEmail').value;
         if (email) {
        localStorage.setItem('userEmail', email);
        }
            welcomeScreen.style.display = 'none';
            questionScreen.style.display = 'block';
            loadQuestion(currentQuestion);
        }
        
        function loadQuestion(index) {
            const question = QUESTIONS[index];
            
            // Update progress
            const progress = ((index + 1) / QUESTIONS.length) * 100;
            progressFill.style.width = `${progress}%`;
            
            // Update question info
            questionNumber.textContent = `Question ${index + 1} of ${QUESTIONS.length}`;
            questionText.textContent = question.text;
            
            // Clear options
            optionsContainer.innerHTML = '';
            
            // Add options
            question.options.forEach((option, i) => {
                const button = document.createElement('button');
                button.className = 'option-btn';
                if (answers[index] === i) {
                    button.classList.add('selected');
                }
                button.textContent = option;
                button.onclick = () => selectOption(i);
                optionsContainer.appendChild(button);
            });
            
            // Update navigation buttons
            prevBtn.style.display = index === 0 ? 'none' : 'block';
            
            if (index === QUESTIONS.length - 1) {
                nextBtn.textContent = 'Submit Assessment';
                nextBtn.className = 'nav-btn submit-btn';
            } else {
                nextBtn.textContent = 'Next Question';
                nextBtn.className = 'nav-btn next-btn';
            }
        }
        
        function selectOption(optionIndex) {
            // Remove selection from all options
            document.querySelectorAll('.option-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            // Select current option
            event.target.classList.add('selected');
            answers[currentQuestion] = optionIndex;
        }
        
        function nextQuestion() {
            if (answers[currentQuestion] === null) {
                alert('Please select an option before continuing.');
                return;
            }
            
            if (currentQuestion < QUESTIONS.length - 1) {
                currentQuestion++;
                loadQuestion(currentQuestion);
            } else {
                calculateResults();
                showResults();
            }
        }
        
        function prevQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                loadQuestion(currentQuestion);
            }
        }
        
        function calculateResults() {
            // Reset scores
            domainScores = {A: 0, B: 0, C: 0, D: 0};
            
            // Calculate scores
            answers.forEach((answerIndex, questionIndex) => {
                if (answerIndex !== null) {
                    const question = QUESTIONS[questionIndex];
                    const domain = question.mapping[answerIndex];
                    domainScores[domain]++;
                }
            });
        }
        
        function showResults() {
            questionScreen.style.display = 'none';
            resultsScreen.style.display = 'block';
            
            // Clear previous results
            resultsGrid.innerHTML = '';
            
            // Add domain result cards
            Object.entries(domainScores).forEach(([domainKey, score]) => {
                const card = document.createElement('div');
                card.className = 'domain-card';
                card.innerHTML = `
                    <div class="domain-name">${DOMAINS[domainKey]}</div>
                    <div class="domain-score">${score}</div>
                    <div class="domain-total">out of ${QUESTIONS.length}</div>
                    <div class="progress-bar" style="margin-top: 15px; height: 6px;">
                        <div class="progress-fill" style="width: ${(score / QUESTIONS.length) * 100}%"></div>
                    </div>
                `;
                resultsGrid.appendChild(card);
            });
            
            // ========== GOOGLE SHEETS DATA COLLECTION ==========
            async function sendToGoogleSheets() {
           // Create a unique session ID
            const sessionId = Date.now() + '-' + Math.random().toString(36).substr(2, 9);
    
        // Prepare data to send
        const submissionData = {
            timestamp: new Date().toISOString(),
            sessionId: sessionId,
            answers: answers,
            scores: domainScores,
            email: localStorage.getItem('userEmail') || 'anonymous'
    };
    
    // Your Google Apps Script Web App URL (see setup below)
    const scriptURL = 'https://script.google.com/macros/s/AKfycbwcWUZ1jc5-8LYff-4FWKYlmeNc7uMRMNHP_rscNZVvCvPic7kg7q86y8kVg_tz99FI2g/exec';
    
    try {
        const response = await fetch(scriptURL, {
            method: 'POST',
            mode: 'no-cors', // Required for Google Apps Script
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(submissionData)
        });
        
        console.log('Data submitted successfully');
    } catch (error) {
        console.log('Submission failed, saving locally instead');
        saveToLocalStorage(submissionData);
    }
}

    function saveToLocalStorage(data) {
         // Get existing submissions or create new array
        const existingData = JSON.parse(localStorage.getItem('assessmentSubmissions') || '[]');
    
         // Add new submission
        existingData.push(data);
    
         // Save back to localStorage
        localStorage.setItem('assessmentSubmissions', JSON.stringify(existingData));
    
         // Optionally, show download button for admin
        showDataDownloadButton();
}
        }
        
        function restartAssessment() {
            currentQuestion = 0;
            answers = new Array(QUESTIONS.length).fill(null);
            domainScores = {A: 0, B: 0, C: 0, D: 0};
            
            resultsScreen.style.display = 'none';
            questionScreen.style.display = 'block';
            loadQuestion(currentQuestion);
        }
        
        // ========== INITIALIZATION ==========
        // Make sure we have exactly 24 questions
        if (QUESTIONS.length !== 24) {
            console.warn(`Warning: Expected 24 questions, but found ${QUESTIONS.length}. Please add all questions.`);
        }
    </script>
</body>
</html>
